Code from succesful 90 minutes Spark challenge
